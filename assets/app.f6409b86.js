import"./style.a87c9e06.js";function f(t){try{return t.fields.filter(e=>e.tooltip.indexOf("Issue type")!=-1).map(e=>e.value)[0]}catch{console.log("Impossible de r\xE9cup\xE9rer le Jira"),console.log(t)}}async function u(){const t=(await miro.board.get({type:"connector"})).filter(e=>e.captions.filter(s=>s.content==="doublon").length>0);console.log(t),t.forEach(e=>miro.board.remove(e))}async function y(){const t=(await miro.board.get({type:"card"})).filter(o=>o.type==="card"),e=await miro.board.get({type:"connector"}),s=t.reduce((o,i)=>{const n=f(i);return n&&(o[n]=o[n]?[...o[n],i.id]:[i.id]),o},{});Object.keys(s).forEach(async o=>{if(s[o].length>1){const i=s[o].shift();s[o].forEach(async n=>{e.find(r=>{var c,a,d,m;return((c=r.start)==null?void 0:c.item)===i&&((a=r.end)==null?void 0:a.item)===n||((d=r.start)==null?void 0:d.item)===n&&((m=r.end)==null?void 0:m.item)===i})||await miro.board.createConnector({shape:"straight",start:{item:i},end:{item:n},style:{strokeColor:"#f24726",strokeWidth:8},captions:[{content:"doublon"}]})})}})}document.getElementById("identifierDoublons").onclick=y;document.getElementById("identifierDoublonsCancel").onclick=u;document.getElementById("rocket").onclick=()=>{document.getElementById("rocket").style.display="none",document.getElementById("rocket2").style.display="block"};const p=t=>t.type==="card",g=t=>t.type==="card"&&t.fields.some(e=>e.tooltip.indexOf("GOJIRA KEY")>-1);miro.board.ui.on("selection:update",async t=>{const e=t.items.filter(p);console.log(e);const s=e.map(l=>l.fields.filter(r=>r.tooltip.indexOf("Issue key")!=-1)[0].value),o=e.filter(g).map(l=>l.fields.filter(r=>r.tooltip.indexOf("GOJIRA KEY")!=-1)[0].value);console.log(s);const i="key in ("+s.join(", ")+")",n="key in ("+o.join(", ")+")";document.getElementById("jiraIds").innerText=i,document.getElementById("gojiraIds").innerText=n,document.getElementById("jira-href").href="https://sixenedis.atlassian.net/issues/?jql="+encodeURIComponent(i),document.getElementById("gojira-href").href="https://gojira.enedis.fr/issues/?jql="+encodeURIComponent(n)});
